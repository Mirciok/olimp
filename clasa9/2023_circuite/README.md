Still unfinished, some errors still have to be checked
